<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Space Weather</title>
    <style>
      img {
        width: 50px;
        background-color: ;
      }
    </style>
  </head>
  <body>
    <div id="navbar-container">
      <div id="navbar">
        <ul>
          <li>Logo</li>
          <li>Card Title</li>
          <li>Mars</li>
          <li>Other</li>
        </ul>
      </div>
    </div>

    <div id="main-events">
      <h1>Space Weather Events</h1>
      <div class="icons">
        <!-- <img src="/icons/earth.png" alt="" srcset="" />
        <img src="/icons/clipboard.png" alt="" srcset="" />
        <img src="/icons/explosive.png" alt="" srcset="" /> -->
      </div>
    </div>

    <div id="footer"></div>

    <script>
      let solarEventsArray = (function () {
        let eventsArray = [];
        let apiRequest = (async function sendApiRequest() {
          let API_KEY = "IltOH3vL9ODoatveN6ZaNL7RFPlvjTGyp6Z6kTT9";

          let response = await fetch(
            `https://api.nasa.gov/DONKI/notifications?startDate=2021-09-010&endDate=2021-09-20&type=all&api_key=${API_KEY}`
          );

          let data = await response.json();
          console.log("data: ", data);
          createDailyEvents(data);
        })();

        function createDailyEvents(data) {
          // loop to move api data --> array... could be array.from?
          for (let i = 0; i < data.length; i++) {
            eventsArray.push({
              eventName: data[i].messageType,
              time: (new Date(data[i].messageIssueTime)).toLocaleString(),
              message: data[i].messageBody,
              messageURL: data[i].messageURL,
              // need education links later/intensity-quick-view?
            });
          }
          // loop to paint each HTML item below previous item
          //   paintHTML(solarEventsArray[0]);
          for (let i = 0; i < data.length; i++) {
            paintHTML(solarEventsArray[i]);
          }
        }

        // make HTML element per item, append to main-event below previous element. LOOP at line 62
        function paintHTML(data) {
        //   console.log(data);
          let rootEvents = document.getElementById("main-events");
          let newEvent = document.createElement("div");

        // `Event: ${data.eventName}, 
        //Date: ${data.time}, 
        //more info: ${data.messageURL}`;

          // will add other icons later
          if (data.eventName === "CME") {
            newEvent.innerHTML += '<img src="/icons/nuclear-explosion.png"/>';
            newEvent.innerHTML += ' <strong>Coronal Mass Ejection</strong>';
            newEvent.innerHTML += '<p>' + data.time + '</p>';
          } else if (data.eventName === "IPS") {
            newEvent.innerHTML += '<img src="/icons/explosion.png"/>';
            newEvent.innerHTML += ' <strong>Interplanetary Shock </strong>';
            newEvent.innerHTML += '<p>' + data.time + '</p>';
          } else if (data.eventName === "Report") {
            newEvent.innerHTML += '<img src="/icons/clipboard.png"/>';
            newEvent.innerHTML += ' <strong>NASA Report </strong>';
            newEvent.innerHTML += '<p>' + data.time + '</p>';
          } else if (data.eventName === "RBE") {
            newEvent.innerHTML += '<img src="/icons/earth.png"/>';
            newEvent.innerHTML += ' <strong>Radiation Belt Enhancement </strong>';
            newEvent.innerHTML += '<p>' + data.time + '</p>';
          }

          rootEvents.appendChild(newEvent);
          //need better way to adjust dates shown
        }
        // console.log(solarEventsArray[0])
        // paintHTML(solarEventsArray[0]);

        return eventsArray;
      })();
    </script>
  </body>
</html>
